# Linux笔记24--软件包管理5-rpm命令管理4-校验和文件提取

1. RPM包校验

   rpm -V 已安装的包名      校验指定RPM包中的文件（V--verify）

   若某文件已经修改过，会出现类似    S.5....T.   c   /etc/httpd/conf/httpd/conf   的执行结果

   + 修改标志

     | 修改标志 | 含义                                              |
     | -------- | ------------------------------------------------- |
     | S        | 文件大小是否改变                                  |
     | M        | 文件类型或者文件权限（rwx）是否改变               |
     | 5        | 文件MD5校验和是否改变（可以看成文件内容是否改变） |
     | D        | 设备的中，从代码是否改变                          |
     | L        | 文件路径是否改变                                  |
     | U        | 文件的属主（所有者）是否改变                      |
     | G        | 文件的属组是否改变                                |
     | T        | 文件的修改时间是否改变                            |

   + 文件类型

     | 标志 | 文件类型                                                     |
     | ---- | ------------------------------------------------------------ |
     | c    | 配置文件（config file）                                      |
     | d    | 普通文件（documentation）                                    |
     | g    | “鬼”文件（ghost file），很少见，就是该文件不应该被这个RPM包包含 |
     | l    | 授权文件（license file）                                     |
     | r    | 描述文件（read me）                                          |

2. RPM包中文件提取

   常用于在误操作后修复某命令或配置文件等

   rpm2cpio 包全名 | \                                ==\代表一条命令没有输完，下一行继续输==

   cpio -idv .文件绝对路径                            ==.代表把指定文件提取到当前路径下==	

   

   + rpm2cpio：将rpm包转换为cpio格式的命令

   + cpio：是一个标准工具，用于创建软件档案文件和从档案文件中提取文件

     cpio 选项 <[文件|设备]

     | 选项 | 含义                                  |
     | ---- | ------------------------------------- |
     | -i   | copy-in模式，还原（从文件中提取数据） |
     | -d   | 还原时自动新建目录                    |
     | -v   | 显示还原过程                          |

   例：

   ​	rpm -qf /bin/ls                #查询ls命令属于哪个软件包

   ​	mv /bin/ls /tmp/             #造成ls命令误删除的假象

   ​	rpm2cpio /mnt/cdrom/Packages/coreutils-8.22-21.el7.x86_64.rpm | cpio -idv ./bin/ls

   ​																								#提取RPM包中/bin/ls命令到当前目录的/bin/ls下

   ​																								#应该是/uer/bin/ls，但是也没有成功

   ​	cp /root/bin/ls /bin/        #把ls命令复制回/bin/目录，修复文件丢失

   ​	==该实验没有成功，，，，，别尝试。。。。。。==

