# LinuxTips28--TC3-HTB队列与过滤器

1. HTB（Hierarchical Token Bucket , 分层的令牌桶）

   + 概念

     + HTB使用令牌和存储桶的概念，以及基于类的系统和过滤器，以允许对流量进行复杂和精细的控制
     + HTB规则允许用户定义所使用的的令牌和桶的特征，并允许用户以任意方式嵌套这些桶
     + 当HTB队列与分类方案结合使用时，可以非常精细地控制流量。

   + HTB参数

     + default

       + HTB队列的可选参数
       + 默认值为0，代表任何未分类的流量以物理网卡的速率出队，完全绕过连接到根队列的任何分类
       + 如果指定了default的值，未分类（不能和filter匹配）的流量（默认的）会被送到这个参数所指定的类中

     + rate

       用来设置限制传输的流量速率

     + ceil

       + 用来设置限制传输流量的最大所需速率。

       + 如果需要设置共享带宽，则需要使用此参数==?==

       + 这个参数可以被认为相当于是“可突发带宽”

     + burst

       + 桶的大小
       + 桶的概念就是TBF中的令牌
       + 用于处理数据的传输时必要的参数     
       
     + cburst
     
       + ceil桶的大小
       + 在等待更多的令牌到来之前，HTB会使cburst字节出列
     
     + quantum
     
       + 每轮当前的类能发送的字节数
       + 用来控制租借带宽的关键参数
       + 默认计算：quantum=rate/r2q
       + quantum必须大于1500小于60000
       + quantum只在class的流量超过了rate但没有超过ceil时使用，它的值越小，带宽共享的效果就越好

