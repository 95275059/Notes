# LinuxTips58--进程管理

### 信号

+ 信号Signal的全称为**软中断信号**，是用来通知进程发生了异步事件，是在软件层次上对中断机制的一种模拟。

+ 原理上一个进程收到一个信号与CPU收到一个中断请求可以说是类似的。

+ **信号是进程间通信机制中唯一的异步通信机制**，一个进程不必通过任何操作来等待信号的到达。

  事实上进程也不知道信号到底什么时候到达，进程之间可以相互通过系统调用`kill`发送软中断信号。

  内核也可以因为内部事件而给进程发送信号，通知进程发生了某个事件。

+ 信号机制除了基本通知功能外，还可以传递附加信息。

+ 信号是Linux系统编程中非常重要的概念，信号机制是进程间传递消息的一种机制，是异步进程中通信的一种方式。

  比如终端用户输出`Ctrl+c`来终端程序时会通过信号机制停止程序的执行。

+ 信号的作用是通知进程发生了异步事件，进程之间可以调用系统传递信号，内核本身也可以发送信号给进程，告知该进程发生了某个事件。
+ 在应用层可以将消息传递给内核监控，当消息处理完毕后，内核将消息反馈给应用层，这样操作不会出现阻塞等待，保持信号处理的持续性。
+ **注意，信号只是用来通知某进程发生了什么事件，并不给该进程传递任何数据。**
+ 接收信号的进程对不同的信号有三种处理方法
  + 指定处理函数
  + 忽略
  + 根据系统默认值处理, 大部分信号的默认处理是终止进程

### Linux系统信号类型

+ POSIX标准的规则信号(regular signal 1-31编号)

  | 信号编号 | 名称             | 默认动作 | 说明                                              |
  | :------- | :--------------- | :------- | :------------------------------------------------ |
  | 1        | SIGHUP           | 终止     | 终止控制终端或进程                                |
  | 2        | **SIGINT**       | 终止     | 由键盘引起的终断(Ctrl-c)                          |
  | 3        | SIGQUIT          | dump     | 控制终端发送给进程的信号, 键盘产生的退出(Ctrl-\), |
  | 4        | GIGILL           | dusmp    | 非法指令引起                                      |
  | 5        | SIGTRAP          | dump     | debug中断                                         |
  | 6        | SIGABRT/SIGIOT   | dump     | 异常中止                                          |
  | 7        | SIGBUS/SIGEMT    | dump     | 总线异常/EMT指令                                  |
  | 8        | SIGFPE           | dump     | 浮点运算溢出                                      |
  | 9        | **SIGKILL**      | 终止     | 强制杀死进程(大招, 进程不可捕获)                  |
  | 10       | SIGUSR1          | 终止     | 用户信号, 进程可自定义用途                        |
  | 11       | SIGSEGV          | dump     | 非法内存地址引起                                  |
  | 12       | SIGUSR2          | 终止     | 用户信号, 进程可自定义用途                        |
  | 13       | SIGPIPE          | 终止     | 向某个没有读取的管道中写入数据                    |
  | 14       | **SIGALRM**      | 终止     | 时钟中断(闹钟)                                    |
  | 15       | **SIGTERM**      | 终止     | 进程终止(进程可捕获)                              |
  | 16       | SIGSTKFLT        | 终止     | 协处理器栈错误                                    |
  | 17       | SIGCHLD          | 忽略     | 子进程退出或中断                                  |
  | 18       | SIGCONT          | 继续     | 如进程停止状态则开始运行                          |
  | 19       | SIGSTOP          | 停止     | 停止进程运行                                      |
  | 20       | SIGSTP           | 停止     | 键盘产生的停止                                    |
  | 21       | SIGTTIN          | 停止     | 后台进程请求输入                                  |
  | 22       | SIGTTOU          | 停止     | 后台进程请求输出                                  |
  | 23       | SIGURG           | 忽略     | socket发送紧急情况                                |
  | 24       | SIGXCPU          | dump     | CPU时间限制被打破                                 |
  | 25       | SIGXFSZ          | dump     | 文件大小限制被打破                                |
  | 26       | SIGVTALRM        | 终止     | 虚拟定时时钟                                      |
  | 27       | SIGPROF          | 终止     | profile timer clock                               |
  | 28       | SIGWINCH         | 忽略     | 窗口尺寸调整                                      |
  | 29       | SIGIO/SIGPOLL    | 终止     | I/O可用                                           |
  | 30       | SIGPWR           | 终止     | 电源异常                                          |
  | 31       | SIGSYS/SYSUNUSED | dump     | 系统调用异常                                      |

  + **注意: 由于不同系统中同一个数值对应的信号类型不一样, 所以最好使用信号名称.**
  + **信号的数值越小, 优先级越高.**

  + SIGINT

    当按下键盘(Ctrl-c)组合键时进程就会收到这个信号

  + SIGTERM

    当用户输入 kill sigterm pid. 对应的进程就会收到这个信号. 这个信号进程是可以捕获并指定函数处理, 例如做一下程序清理等工作. 甚至忽视这个信号

  + SIGKILL

    强制杀死进程, 这个信号进程无法忽视, 直接在系统层面把进程杀掉. 所以在Python中他的不能监听的

  + SIGALRM

    闹钟信号

+ 实时信号(real-time signal 32-63)

### SIGTERM与SIGKILL的区别

https://www.linuxrumen.com/cyml/1667.html