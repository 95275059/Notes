# 第四章--应用密码学与前沿选讲

1. 密码学的基本概念

   + 密码学的目标

     + 机密性：对信息实现隐藏
     + 真实性：用户的身份是真实的
     + 完整性：信息未经授权不能进行修改
     + 不可否认性：不能否认或抵赖曾经完成的操作或承诺

   + 密码体制模型

     <img src="4-1.png" alt="4-1" style="zoom:75%;" />

     + **明文（M）：**原始可理解的消息或数据。
     + **加密算法（E）：**对明文进行各种代换和变化，从明文到密文的变换
     + **加密秘钥（Ke）：**加密密钥是加密算法的输入，独立于明文和算法。算法根据所用的特定密钥而产生不同的输出，算法所用的代换和变换也依靠密钥。
     + **密文(C)：**加密后的消息，加密算法的输出，看起来是完全随机而杂乱的消息。
     + **信道：**密文传输的通道。
     + **解密算法(D)：**是加密算法的逆运算。输入密文和解密密钥，输出原始明文。
     + **解密密钥(Kd)：**用于解密密文，还原出明文，是解密算法的输入，与加密密钥有某种相关性。
     + **安全通道：**用于传递、分发密钥。
     + **加密：C = E(Ke, M )**
     + **解密：M= D(Kd, C) = D(Kd, E(Ke, M ))** 

   + 密码体制分类

     + 对称密码体制

       对称密码体制又称**单钥(one-key) 或私钥（private key）或传统(classical)密码体制**。在对称密码体制中，**加密密钥和解密密钥是一样的或者彼此之间是容易相互确定的**。

       按照加密方式，可分为**流密码(stream cipher)**和**分组密码(block cipher)**

       + 流密码

         在流密码中将明文消息按字符逐位地进行加密。 

       + 分组密码

         在分组密码中将明文消息分组（每组含有多个字符），逐组地进行加密。 

     + 非对称密码体制

       非对称密码体制又称**双钥(two-key) 或公钥(public key)密码体制**。在公钥密码体制中，**加密密钥和解密密钥不同**，**加密密钥可以公开而解密密钥需要保密**，**从加密密钥推导出解密密钥，在计算上是不可能的**。

2. 对称密码体制

   + 基本概念

     <img src="4-2.png" alt="4-2" style="zoom:75%;" />

     + Plaintext(Messge):明文
     + Encryption algorithm:加密算法
     + Secret Key:秘钥
     + Ciphertext:密文
     + Decryption algorithm:解密算法

   + 流密码（Stream Cipher）

     + 加密以明文比特或字节为单位，以伪随机序列与明文序列模2加后，作为密文序列每次处理数据流中的一个比特或字节

     + **密文不仅与最初给定的算法和密钥有关，同时也与明文位置有关(是所处位置的函数) **

     + 例如：**RC4、一次一密系统、AutoKey、 Vigenere等**

   + 分组密码（Block Cipher）

     + 通常以大于等于64位的数据块为处理单位，加密得**相同长度**密文
     + **经过加密所得到的密文仅与给定的密码算法和密钥有关**，与被处理的明文数据在整个明文中的位置无关。
     + 例如：**DES、AES等**

   + 高级加密标准（AES）

     + 起源

       DES不够安全

       3DES（或称T-DES）安全，但速度慢

       2000年10月，Rijndael（Rijn [rain] dael [del] (莱恩戴尔)）算法被选中，作为AES算法

       2001年11月，NIST发布最终标准FIPS PUB 197

     + AES参数

       + 密钥长度：128位、192位、256位（本章密钥长度为128）

       + 分组长度：128

         ![4-3](4-3.png)

       + 特性

         对所有已知的攻击免疫

         在各种平台上，执行速度快且代码紧凑

         设计简单

     + AES结构（不是Feistel结构)

       + 过程

         + 输入分组以正方形矩阵S描述
         + 密钥扩展为矩阵
         + 进行9/11/13轮迭代
           + 字节代换：S盒
           + 行移位：置换
           + 列混淆：GF(2^8)
           + 轮密钥加：XOR
         + 最后最后一个不完整轮
         + 矩阵state转换为输出分组

         <img src="4-4.png" alt="4-4"  />

       + 以上各个步骤可逆

       + **在算法的开始和结束都有轮密钥加阶段**

         若以其它不需要密钥的运算用于开始和结束，则不需要密钥也可求其逆，不能增加安全性

       + 在每轮迭代中

         轮密钥加实质上是一种Vernam密码，本身不难破译

         **字节代换、行移位、列混淆三个阶段一起提供了混淆、扩散和非线性功能**。**这些阶段没有涉及密钥，其本身并不提供安全性**

         各阶段均可逆

         解密算法与加密算法并不一样，各阶段为逆操作（轮密钥加阶段算法相同）

       + **输入分组描述**

         + 输入分组用以字节为单位的正方形矩阵State描述（状态）
         + 矩阵中字节排列顺序是**从上到下从左到右的**
         + 然后对State进行迭代运算
         + 最后将State转换为输出分组

       + **秘钥扩展**

         

3. 非对称密码体制

4. 散列函数与散列算法

5. 密码技术应用

6. 密码技术研究前沿宣讲

   